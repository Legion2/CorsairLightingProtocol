<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Corsair Lighting Protocol: Corsair Lighting Protocol</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Corsair Lighting Protocol
   &#160;<span id="projectnumber">0.14.2</span>
   </div>
   <div id="projectbrief">Control LEDs connected to an Arduino with iCUE</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Corsair Lighting Protocol </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://www.ardu-badge.com/Corsair%20Lighting%20Protocol"><object type="image/svg+xml" data="https://www.ardu-badge.com/badge/Corsair%20Lighting%20Protocol.svg?" style="pointer-events: none;">arduino-library-badge</object></a> <a href="https://github.com/Legion2/CorsairLightingProtocol/actions?query=workflow%3ATest+branch%3Adev+event%3Apush"><object type="image/svg+xml" data="https://github.com/Legion2/CorsairLightingProtocol/workflows/Test/badge.svg" style="pointer-events: none;">Test Status</object></a> <a href="https://isitmaintained.com/project/Legion2/CorsairLightingProtocol" title="Average time to resolve an issue"><object type="image/svg+xml" data="https://isitmaintained.com/badge/resolution/Legion2/CorsairLightingProtocol.svg" style="pointer-events: none;">Average time to resolve an issue</object></a></p>
<p><a href="https://www.corsair.com/icue"><img src="extra/images/iCUEDarkBadge.png" alt="iCUE" height="80" class="inline"/></a> <a href="https://rgbsync.com/"><img src="extra/images/RGBSyncDarkBadge.png" alt="RGBSync" height="80" class="inline"/></a> <a href="https://gitlab.com/CalcProgrammer1/OpenRGB"><img src="extra/images/OpenRGBBadge.png" alt="OpenRGB" height="80" class="inline"/></a></p>
<p><b>This library can be used to integrate custom/unofficial RGB strips with iCUE.</b> <em>This is not an official corsair project.</em></p>
<h1>Features</h1>
<ul>
<li>Add support of Corsair DIY device protocol to Arduino.</li>
<li>Control LEDs with the <a href="https://www.corsair.com/icue">Corsair iCUE software</a>.</li>
<li><a href="https://github.com/FastLED/FastLED/wiki/Overview#chipsets">Support common LED chipsets</a>. (e.g. WS2812B, WS2801)</li>
<li>Support <a href="http://fastled.io/">FastLED</a>.</li>
<li>Supported platform: Arduino AVR</li>
<li>Hardware Lighting mode.</li>
<li>Use multiple devices at the same time.</li>
<li>Repeat or scale LED channels to arbitrary size.</li>
</ul>
<h2>Supported Devices</h2>
<ul>
<li>Lighting Node PRO</li>
<li>Commander PRO</li>
<li>Lighting Node CORE</li>
<li>LS100 Smart Lighting Controller</li>
<li>LT100 Smart Lighting Towers</li>
</ul>
<div class="image">
<img src="overview.png" alt=""/>
<div class="caption">
Overview</div></div>
   <h1>Getting started</h1>
<p>This project is an Arduino library called "Corsair Lighting Protocol". It can be used to control Arduino boards with iCUE. This project provides example sketches for easy use with Arduino IDE.</p>
<ul>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#install-the-libraries">Install the libraries</a></li>
<li><a href="#create-a-lighting-node-pro">Create a Lighting Node PRO</a></li>
<li><a href="#use-the-lighting-node-pro">Use the Lighting Node PRO</a></li>
</ul>
<h2>Requirements</h2>
<p>The library is compatible with all boards using the MCU ATmega32U4. This includes <b>Arduino Leonardo</b>, <b>SparkFun Pro Micro</b>, <b>Arduino Micro</b>, and <b>Adafruit 32u4 AVR Boards</b>. It also supports the Arduino Uno and Arduino Mega, <b>but</b> this requires the <a href="https://github.com/NicoHood/HoodLoader2">HoodLoader2</a> bootloader, see <a href="https://github.com/Legion2/CorsairLightingProtocol/wiki/How-to-use-on-Arduino-Uno-and-Arduino-Mega">this wiki</a> for more details. It is <b>not</b> compatible with ATmega328 (Arduino Nano), STM8S103F3, teensy, ESP8266 and ESP32 see <a href="https://github.com/Legion2/CorsairLightingProtocol/issues?q=is%3Aissue+label%3Aarchitecture%2Fplatform">list of architecture/platform</a> for a detailed description why they are not supported. In the rest of the documentation "Arduino" is used as a synonym for all supported boards regardless of the manufacturer.</p>
<p>When you have problems with a board not listed here, please open an <a href="https://github.com/Legion2/CorsairLightingProtocol/issues">Issue</a>.</p>
<h2>Install the libraries</h2>
<p>To use this library you must install it with the Library-Manager. Open the Library-Manager in Arduino IDE via Tools-&gt;Manage Libraries... Search for "Corsair Lighting Protocol" and install the Corsair Lighting Protocol library. This library also requires the <a href="http://fastled.io/">FastLED</a> library. Search for "FastLED" in the Library-Manager and install the FastLED library.</p>
<h2>Create a Lighting Node PRO</h2>
<p>This guide will teach you how to create a Lighting Node PRO with an Arduino Leonardo compatible board. If you have an Arduino Uno or Mega, see the <a href="https://github.com/Legion2/CorsairLightingProtocol/wiki/How-to-use-on-Arduino-Uno-and-Arduino-Mega">other guide</a>.</p>
<ol type="1">
<li><p class="startli">Open the example "LightingNodePRO", you can find it in Arduino IDE in the File menu-&gt;Examples-&gt;Corsair Lighting Protocol-&gt;LightingNodePRO. If you can't open the LightingNodePRO example the Corsair Lighting Protocol library is not installed correctly.</p>
<div class="image">
<img src="open-example.png" alt=""/>
<div class="caption">
open example sketch</div></div>
   </li>
</ol>
<ol type="1">
<li><p class="startli">Install the <a href="https://github.com/Legion2/CorsairLightingProtocolBoards">CLP Boards</a>. They can be installed by following the <a href="https://github.com/Legion2/CorsairLightingProtocolBoards#how-to-use-these-boards-in-arduino">CLP Boards installation guide</a>. After installation it should be possible to select the CLP Boards in the Arduino IDE as shown in the screenshot below. If your are using a Sparkfun Pro Micro also install the <a href="https://github.com/sparkfun/Arduino_Boards#installation-instructions">SparkFun Boards definition</a>.</p>
<div class="image">
<img src="select-board.png" alt=""/>
<div class="caption">
select CLP Board</div></div>
   </li>
</ol>
<ol type="1">
<li><p class="startli">Upload the "LightingNodePRO" sketch to your Arduino.</p>
<div class="image">
<img src="upload-sketch.png" alt=""/>
<div class="caption">
upload sketch</div></div>
   </li>
</ol>
<ol type="1">
<li><p class="startli">Do the wiring. For more information on <a href="https://github.com/FastLED/FastLED/wiki/Wiring-leds">how to wire the leds</a> and <a href="https://github.com/FastLED/FastLED/wiki/Basic-usage#setting-up-the-leds">how to set up the LEDs in the code</a> see the links.</p>
<div class="image">
<img src="board-wiring.jpg" alt=""/>
<div class="caption">
the wiring</div></div>
   </li>
</ol>
<ol type="1">
<li>Verify your device works as expected. Open the Windows settings-&gt;devices-&gt;Other devices. Somewhere in the list of devices, there should be a device called "Lighting Node PRO".</li>
</ol>
<ol type="1">
<li>Now open <a href="https://www.corsair.com/icue">iCUE</a> there you should see the "Lighting Node PRO".</li>
</ol>
<h2>Use the Lighting Node PRO</h2>
<div class="image">
<img src="iCUE.jpg" alt=""/>
<div class="caption">
iCUE RGB Strip example</div></div>
   <p>In iCUE open the "Lighting Setup" tab of the Lighting Node PRO(LNP) and set for both Lighting Channels the device to "RGB Light Strip" and the amount to a tenth of the LEDs you have. iCUE groups the LEDs into groups of ten. So if you have 20 LEDs, set the amount to 2. Now you can create lighting effects in the "Lighting Channel #" tabs.</p>
<h1>Documentation</h1>
<ul>
<li><a href="https://legion2.github.io/CorsairLightingProtocol/">API Documentation</a></li>
<li><a href="#how-it-works">How it works</a></li>
<li><a href="#use-of-multiple-devices">Use of multiple devices</a></li>
<li><a href="#repeat-or-scale-led-channels">Repeat or scale LED channels</a></li>
<li><a href="#increase-the-brightness-of-the-leds">Increase the Brightness of the LEDs</a></li>
<li><a href="#hardware-lighting-mode">Hardware Lighting mode</a></li>
</ul>
<h2>How it works</h2>
<p>This library uses the USB HID interface of the ATmega32U4. After uploading a sketch with the library and selected CLP Boards, iCUE recognizes the Arduino as a Corsair device, because the CLP Boards use USB IDs of Corsair. In iCUE you can then select the device and set some lighting effects. iCUE sends these via the HID protocol to the Arduino. These commands are understood by the library and converted into lighting effects on the RGB strips connected to the Arduino. The <a href="http://fastled.io/">FastLED</a> library is used to control the LEDs.</p>
<h2>Use of multiple devices</h2>
<p>Each device has two unique IDs, that is, they should be unique. You must give each device a unique ID. There are two IDs that must be changed <code>Serial Number</code> and <code>DeviceID</code>.</p>
<p>The Serial Number can be set in the constructor of <code><a class="el" href="classCorsairLightingProtocolHID.html">CorsairLightingProtocolHID</a></code> and <code><a class="el" href="classCLPUSBSerialBridge.html">CLPUSBSerialBridge</a></code> as shown in the <a href="examples/AdditionalFeatures/AdditionalFeatures.ino">example</a>. </p><div class="fragment"><div class="line"> {C++}</div>
<div class="line">const char mySerialNumber[] PROGMEM = &quot;202B6949A967&quot;;</div>
<div class="line">CorsairLightingProtocolHID cHID(&amp;cLP, mySerialNumber);</div>
</div><!-- fragment --><p>The Serial Number MAY only consist of HEX characters (0-9 and A-F).</p>
<p>The DeviceID can be set with the <code>setDeviceID</code> function of <code><a class="el" href="classCorsairLightingFirmware.html">CorsairLightingFirmware</a></code>. </p><div class="fragment"><div class="line"> {C++}</div>
<div class="line">void setup() {</div>
<div class="line">    byte deviceId[4] = { 0x9A, 0xDA, 0xA7, 0x8E };</div>
<div class="line">    firmware.setDeviceID(deviceId);</div>
<div class="line">    ...</div>
<div class="line">}</div>
</div><!-- fragment --><h3>Alternative</h3>
<p>The <code>DeviceID</code> can be changed with the <a href="examples/DeviceIDTool/DeviceIDTool.ino">DeviceIDTool</a>. Upload the DeviceIDTool sketch and then open the Serial monitor with baudrate 115200. The tool displays the current DeviceID, you can type in a new DeviceID that is saved on the Arduino. After that, you can upload another sketch.</p>
<h2>Repeat or scale LED channels</h2>
<p>You can repeat or scale LED channel controlled by iCUE onto physical LED strips. This is very useful if you have very long LED strips that are longer than 60/96/135 LEDs, which is the maximum number iCUE supports.</p>
<p>To repeat or scale a LED channel you must apply the <code>CLP::repeat</code> or the <code>CLP:scale</code> function in the update hook of the <a class="el" href="classFastLEDController.html">FastLEDController</a>. See the <a href="examples/RepeatAndScale/RepeatAndScale.ino">RepeatAndScale</a> example for the complete code. Both functions take the <a class="el" href="classFastLEDController.html">FastLEDController</a> pointer and the channel index as arguments. Additionally, the <code>repeat</code> function takes as an argument how often the LED channel should be repeated. For example, if you want to duplicate the channel you must pass <code>2</code> as argument. The <code>scale</code> function takes as third argument the length of the physical LED strip to which it scales the channel using integer scaling. For example you have 144 physical LEDs on you strip and 60 on the LED channel. Then the third argument of the <code>scale</code> function is <code>144</code>.</p>
<p>For both functions it's <b>important</b>, that the CRGB arrays have at least the length of the physical LED strip. This means if your LED channel from iCUE has 50 LEDs and you use the <code>repeat</code> function to control 100 physical LEDs you MUST declare the CRGB array at least with a length of 100.</p>
<h2>Increase the Brightness of the LEDs</h2>
<p>When using LS100 or LT100 iCUE only uses 50% of the LEDs brightness even if you set the brightness to max in the iCUE Device Settings. But there are good news, we can increase the brightness with the Arduino so we can use the full brightness of our LEDs. Add the <code>CLP::fixIcueBrightness</code> function to the <code>onUpdateHook</code> in the setup function as shown in the <a href="examples/AmbientBacklight/AmbientBacklight.ino">example</a>. If there are multiple functions called in <code>onUpdateHook</code>, <code>fixIcueBrightness</code> should be the first. Only use this function with LS100 and LT100 devices! </p><div class="fragment"><div class="line"> {C++}</div>
<div class="line">ledController.onUpdateHook(0, []() {</div>
<div class="line">    CLP::fixIcueBrightness(&amp;ledController, 0);</div>
<div class="line">});</div>
</div><!-- fragment --><h2>Reverse direction of LED Strip</h2>
<p>If you want to change the direction of the LEDs of the Strip without physically change the strip, the <code>CLP::reverse</code> function can be used. The reverse function must be called be for scaling. </p><div class="fragment"><div class="line"> {C++}</div>
<div class="line">ledController.onUpdateHook(0, []() {</div>
<div class="line">    CLP::reverse(&amp;ledController, 0);</div>
<div class="line">});</div>
</div><!-- fragment --><h2>Hardware Lighting mode</h2>
<p>The <a href="https://forum.corsair.com/v3/showthread.php?t=182874">Hardware Lighting mode</a> can be configured in iCUE. It allows you the set lighting effects that will be active when iCUE <b>is not</b> running. This is the case when the PC is off, in sleep mode, booting or the user is logged out. So if you want to have lighing effects in all these situations, use the Hardware Lighting mode. If you don't want it, configure a static black color.</p>
<h1>License</h1>
<p>This project is licensed under the Apache 2.0 License.</p>
<h1>DISCLAIMERS</h1>
<p>This is a DO IT YOURSELF project, use at your own risk!</p>
<h1>Credits</h1>
<ul>
<li><a href="https://github.com/NicoHood/HoodLoader2">HoodLoader2</a></li>
<li><a href="https://github.com/NicoHood/HID">Arduino HID Project</a></li>
<li><a href="https://github.com/audiohacked/OpenCorsairLink/issues/70">Protocol Information</a></li>
</ul>
<h2>Related projects</h2>
<ul>
<li><a href="https://github.com/TylerSeiford/CorsairArduinoController">CorsairArduinoController</a></li>
<li><a href="https://github.com/Legion2/CorsairLightingProtocolBoards">CorsairLightingProtocolBoards</a></li>
<li><a href="https://github.com/McHauge/OpenCorsairLighting">OpenCorsairLighting</a> </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
